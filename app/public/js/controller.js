var app = angular.module('poetry');
app.controller('poetryCtrl', function ($scope) {
    $scope.peotry = [
        {
        'img': 'images/img1.jpg',
        'postDate': '12-3-2016',
        'rating': '',
        'title': 'ಬಿಂಬ',
        'info': 'ಪದೇ ಪದೇ ಹೋದ  ಹೋಟೆಲಿನಲಿ ಬಟ್ಟೆಯಂಗಡಿಯಲಿ ರಸ್ತೆಬದಿಯಲಿ ನಮ್ಮೂರ ದಾರಿಯಲಿ ಹಳೆಯ ಪತ್ರಗಳಲಿ ನಿನ್ನದೇ ಪಾತ್ರಗಳಲಿ ನೀನಿದ್ದು ಬಂದ ಊರುಗಳಲಿ ಪಕ್ಕ ಸರಿಯುವ ಬಸ್ಸು ಕಾರುಗಳಲ್ಲಿ ಎಲ್ಲೋ ಸಿಗದ ನಿನ್ನನ್ನು ನೋಡುವೆನು ಮತ್ತೊಬ್ಬಳ ಕಣ್ಣಿನಲಿ !',
        'like': '12',
        'comments': '4',
        'share': ''
        },
        {
            'img': 'images/img1.jpg',
            'postDate': '12-3-2016',
            'rating': '',
            'title': 'ಸ್ವರ್ಗವಂತೆ ಬೆಂಗಳೂರು ',
            'info': 'ಸ್ವರ್ಗದಲ್ಲಿ ಇಂದ್ರ - ದೇವತೆಗಳ ಆಡಳಿತ ಇಲ್ಲೇನು ಕಮ್ಮಿ ಮೇಯರ್- ಮಂತ್ರಿಗಳ ದುರಾಡಳಿತ ಕಣ್ಣಿಗೆ ಬಿದ್ದುದಿಲ್ಲ ಸ್ವರ್ಗದಲ್ಲಿ  ಶ್ರೀಸಾಮಾನ್ಯ ಬರಿಯ ರಂಭಾ ಮೇನಕೆ ದೇವಗಣ ಇಲ್ಲಿಯೂ ಹಾಗೆಯೇ,  ಕಾಣುವುದಿಲ್ಲ ಜನ ಸಾಮಾನ್ಯ ಕಾಣಬೇಕೆಂದರೆ ಇರಲೇಬೇಕು ಕೈತುಂಬಾ ಹಣ , ಇಲ್ಲಾ ಬಣ್ಣ ಹಸಿವಿಲ್ಲವಂತೆ ಅಲ್ಲಿ , ಬಾಯಾರಿಕೆಗಳಿಲ್ಲ ಆರದ ಸರೋವರಗಳಿಂದ ಇಲ್ಲಿಯೂ ಬಾಯಾರಿಕೆ ಕಮ್ಮಿ ಬಾರ್ ಅಂಡ್ ರೆಸ್ಟೋರಂಟ್ಸ್ ಗಳಿಂದ ಇಂದ್ರನಿಗೂ ಭಯವಂತೆ ಅಲ್ಲಿ ರಕ್ಕಸರ ದಾಳಿಗೆ , ಸ್ವರ್ಗ ಕೈತಪ್ಪಿದರೆ ? ಇಲ್ಲಿಯೂ  ಆಗೆಯೇ ನಿದ್ರೆಯಿಲ್ಲ ಮಂತ್ರಿಗೆ ಖುರ್ಚಿ ಕಳಚಿಬಿದ್ದರೆ ? ಕ್ಷೀರ ಸಾಗರಗಳಂತೆ ? ಬಿಳಿಮೋಡಗಳಂತೆ ! ಇಲ್ಲೂ  ಉಳಿದಿಹವು ಒಂದೆರಡು ಕೆರೆಗಳು ಮೋಡಗಳಂತೆ ಒಂದರ ಹಿಂದೆ ಒಂದರಂತೆ ಲಕ್ಷ ವಾಹನಗಳು ಸಮಯ ಚಲಿಸುವುದಿಲ್ಲವೇನೋ ಅಲ್ಲಿ ಸುಖದ ಅಮಲಿನಲ್ಲಿ ಇಲ್ಲಿಯೂ , ಸಮಯ ಚಲಿಸುವುದಿಲ್ಲ ಕಿಕ್ಕಿರಿದ ರಸ್ತೆಗಳಲ್ಲಿ ನಿನ್ನಂತೆಯೇ ಅಲ್ಲವೇ ಬೆಂಗಳೂರು ಎಲ್ಲರನ್ನೂ ಕರೆವುದಿಲ್ಲಿಗೆ ಕೈಬೀಸಿ ಸುಖವ ತೋರಿಸಿ ಸ್ವರ್ಗವೆಂದರದು ಸ್ವರ್ಗ,  ಇಲ್ಲವೆಂದರೆ ಇಲ್ಲ ಎಲ್ಲವೂ ನಿನ್ನಿಷ್ಟದಂತೆ !',
            'like': '12',
            'comments': '4',
            'share': ''
        },
        {
            'img': 'images/img1.jpg',
            'postDate': '12-3-2016',
            'rating': '',
            'title': 'Bimba',
            'info': 'ಪದೇ ಪದೇ ಹೋದ  ಹೋಟೆಲಿನಲಿ ಬಟ್ಟೆಯಂಗಡಿಯಲಿ ರಸ್ತೆಬದಿಯಲಿ ನಮ್ಮೂರ ದಾರಿಯಲಿ ಹಳೆಯ ಪತ್ರಗಳಲಿ ನಿನ್ನದೇ ಪಾತ್ರಗಳಲಿ ನೀನಿದ್ದು ಬಂದ ಊರುಗಳಲಿ ಪಕ್ಕ ಸರಿಯುವ ಬಸ್ಸು ಕಾರುಗಳಲ್ಲಿ ಎಲ್ಲೋ ಸಿಗದ ನಿನ್ನನ್ನು ನೋಡುವೆನು ಮತ್ತೊಬ್ಬಳ ಕಣ್ಣಿನಲಿ !',
            'like': '12',
            'comments': '4',
            'share': ''
        },
        {
            'img': 'images/img1.jpg',
            'postDate': '12-3-2016',
            'rating': '',
            'title': 'Bimba',
            'info': 'ಸ್ವರ್ಗದಲ್ಲಿ ಇಂದ್ರ - ದೇವತೆಗಳ ಆಡಳಿತ ಇಲ್ಲೇನು ಕಮ್ಮಿ ಮೇಯರ್- ಮಂತ್ರಿಗಳ ದುರಾಡಳಿತ ಕಣ್ಣಿಗೆ ಬಿದ್ದುದಿಲ್ಲ ಸ್ವರ್ಗದಲ್ಲಿ  ಶ್ರೀಸಾಮಾನ್ಯ ಬರಿಯ ರಂಭಾ ಮೇನಕೆ ದೇವಗಣ ಇಲ್ಲಿಯೂ ಹಾಗೆಯೇ,  ಕಾಣುವುದಿಲ್ಲ ಜನ ಸಾಮಾನ್ಯ ಕಾಣಬೇಕೆಂದರೆ ಇರಲೇಬೇಕು ಕೈತುಂಬಾ ಹಣ , ಇಲ್ಲಾ ಬಣ್ಣ ಹಸಿವಿಲ್ಲವಂತೆ ಅಲ್ಲಿ , ಬಾಯಾರಿಕೆಗಳಿಲ್ಲ ಆರದ ಸರೋವರಗಳಿಂದ ಇಲ್ಲಿಯೂ ಬಾಯಾರಿಕೆ ಕಮ್ಮಿ ಬಾರ್ ಅಂಡ್ ರೆಸ್ಟೋರಂಟ್ಸ್ ಗಳಿಂದ ಇಂದ್ರನಿಗೂ ಭಯವಂತೆ ಅಲ್ಲಿ ರಕ್ಕಸರ ದಾಳಿಗೆ , ಸ್ವರ್ಗ ಕೈತಪ್ಪಿದರೆ ? ಇಲ್ಲಿಯೂ  ಆಗೆಯೇ ನಿದ್ರೆಯಿಲ್ಲ ಮಂತ್ರಿಗೆ ಖುರ್ಚಿ ಕಳಚಿಬಿದ್ದರೆ ? ಕ್ಷೀರ ಸಾಗರಗಳಂತೆ ? ಬಿಳಿಮೋಡಗಳಂತೆ ! ಇಲ್ಲೂ  ಉಳಿದಿಹವು ಒಂದೆರಡು ಕೆರೆಗಳು ಮೋಡಗಳಂತೆ ಒಂದರ ಹಿಂದೆ ಒಂದರಂತೆ ಲಕ್ಷ ವಾಹನಗಳು ಸಮಯ ಚಲಿಸುವುದಿಲ್ಲವೇನೋ ಅಲ್ಲಿ ಸುಖದ ಅಮಲಿನಲ್ಲಿ ಇಲ್ಲಿಯೂ , ಸಮಯ ಚಲಿಸುವುದಿಲ್ಲ ಕಿಕ್ಕಿರಿದ ರಸ್ತೆಗಳಲ್ಲಿ ನಿನ್ನಂತೆಯೇ ಅಲ್ಲವೇ ಬೆಂಗಳೂರು ಎಲ್ಲರನ್ನೂ ಕರೆವುದಿಲ್ಲಿಗೆ ಕೈಬೀಸಿ ಸುಖವ ತೋರಿಸಿ ಸ್ವರ್ಗವೆಂದರದು ಸ್ವರ್ಗ,  ಇಲ್ಲವೆಂದರೆ ಇಲ್ಲ ಎಲ್ಲವೂ ನಿನ್ನಿಷ್ಟದಂತೆ !',

            'like': '12',
            'comments': '4',
            'share': ''
        }
        ];

    $scope.author = [
        {
        'name': 'xyzxyzxyzxyz',
        'img': 'images/img1.jpg'
        },
        {
            'name': 'abcabcabcabc',
            'img': 'images/img1.jpg'
        },
        {
            'name': 'fghfghfghfghfgh',
            'img': 'images/img1.jpg'
        },
        {
            'name': 'abcabcabcabc',
            'img': 'images/img1.jpg'
        },
        {
            'name': 'fghfghfghfghfgh',
            'img': 'images/img1.jpg'
        },
        {
            'name': 'abcabcabcabc',
            'img': 'images/img1.jpg'
        },
        {
            'name': 'fghfghfghfghfgh',
            'img': 'images/img1.jpg'
        },
        {
            'name': 'abcabcabcabc',
            'img': 'images/img1.jpg'
        },
        {
            'name': 'fghfghfghfghfgh',
            'img': 'images/img1.jpg'
        },
        {
            'name': 'fghfghfghfghfgh',
            'img': 'images/img1.jpg'
        }
        ];
})
app.controller('regCtrl', ['$scope', '$state', 'AuthService', 'toaster', function ($scope, $state, AuthService, toaster) {
    $scope.register = function () {
        //   var user={};
        //   user.username= $scope.registerForm.username;
        //   user.fname= $scope.registerForm.fname;
        //   user.lname= $scope.registerForm.lname;
        //   user.email= $scope.registerForm.email;
        //   user.phnum= $scope.registerForm.phnum;
        //console.log(user);
        // initial values
        $scope.error = false;
        $scope.disabled = true;
        // call register from service
        AuthService.register($scope.registerForm.username, $scope.registerForm.fname, $scope.registerForm.lname, $scope.registerForm.email, $scope.registerForm.phnum, $scope.registerForm.pwd)
            // handle success
            .then(function () {
                // toaster.success({title: "title", body:"Successfully Registered"});
                toaster.pop('success', "Hi," + $scope.registerForm.fname + " ", "Successfully Registered");
                $state.go('login');
                $scope.disabled = false;
                $scope.registerForm = " ";
            })
            // handle error
            .catch(function () {
                $scope.error = true;
                //$scope.registerForm = {};
                toaster.pop('error', "Username Already exists", null, 'trustedHtml');
                $scope.errorMessage = "Something went wrong!";
                $scope.disabled = false;
            });
    };
}])
app.controller('loginCtrl',
    ['$scope', '$http', '$state', 'AuthService', 'toaster', 'cfpLoadingBar',
        function ($scope, $http, $state, AuthService, toaster, cfpLoadingBar) {
            $scope.Userlogin = function () {
                // initial values
                $scope.error = false;
                $scope.disabled = true;
                // call login from service
                AuthService.login($scope.loginForm.username, $scope.loginForm.password)
                    // handle success
                    .then(function (response) {
                        console.log(response.data.data._id);
                        localStorage.setItem("id", response.data.data._id);
                        cfpLoadingBar.complete();
                        toaster.pop('success', "Welcome To Poetry");
                        $state.go('dashboard', { ID: response.data.data._id });
                        $scope.disabled = false;
                        $scope.loginForm = {};
                    })
                    // handle error
                    .catch(function () {
                        cfpLoadingBar.start();
                        $scope.error = true;
                        // $scope.errorMessage = "Invalid username and/or password";
                        toaster.pop('error', '', "Invalid username and password", null, 'trustedHtml');

                        $scope.disabled = false;
                        $scope.loginForm = {};
                    });
            };
        }])
app.controller('dashboardCtrl', ['$scope', '$http', 'toaster', 'AuthService', 'apiService', function ($scope, $http, toaster, AuthService, apiService) {
    $scope.story = [];
    $scope.changeText = function (){
        if (!$scope.story.text && !$scope.story.title){
            toaster.pop('error', '', "Please fill the fileds", null, 'trustedHtml');
            // toaster.pop('error','',"Please Fill the field", null, 'trustedHtml');
        } else {
            //  $scope.story.push({ 'title': $scope.title, 'data': $scope.text });
            $http.post('/users/story', $scope.story).success(function (response) {
                console.log($scope.story);
            });
        }
    }
    var id = localStorage.id;
    $http.get('/users/api/' + id).success(function (response) {
        $scope.usersDetails = response;
    });
    //    $scope.limit = 3;
    //     $scope.loadMore = function() {
    //       $scope.increamented =  $scope.limit + 3;
    //        $scope.limit = $scope.increamented > scope.textData.length ? scope.textData.length : $scope.increamented;
    //     };
}]);

